!function(t){function e(){this._callbacks=[]}function n(t,n,r,i){var a,u,c=new e;r=r||{},i=i||{};try{a=function(){var t;if(window.XMLHttpRequest)t=new XMLHttpRequest;else if(window.ActiveXObject)try{t=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){t=new ActiveXObject("Microsoft.XMLHTTP")}return t}()}catch(t){return c.done(o.ENOXHR,""),c}for(var s in u=function(t){var e="";if("string"==typeof t)e=t;else{var n=encodeURIComponent;for(var r in t)t.hasOwnProperty(r)&&(e+="&"+n(r)+"="+n(t[r]))}return e}(r),"GET"===t&&u&&(n+="?"+u,u=null),a.open(t,n),a.setRequestHeader("Content-type","application/x-www-form-urlencoded"),i)i.hasOwnProperty(s)&&a.setRequestHeader(s,i[s]);var f=o.ajaxTimeout;if(f)var l=setTimeout(function(){a.abort(),c.done(o.ETIMEOUT,"",a)},f);return a.onreadystatechange=function(){if(f&&clearTimeout(l),4===a.readyState){var t=!a.status||(a.status<200||a.status>=300)&&304!==a.status;c.done(t,a.responseText,a)}},a.send(u),c}function r(t){return function(e,r,o){return n(t,e,r,o)}}e.prototype.then=function(t,n){var r;return this._isdone?r=t.apply(n,this.result):(r=new e,this._callbacks.push(function(){var e=t.apply(n,arguments);e&&"function"==typeof e.then&&e.then(r.done,r)})),r},e.prototype.done=function(){this.result=arguments,this._isdone=!0;for(var t=0;t<this._callbacks.length;t++)this._callbacks[t].apply(null,arguments);this._callbacks=[]};var o={Promise:e,join:function(t){var n=new e,r=[];if(!t||!t.length)return n.done(r),n;var o=0,i=t.length;function a(t){return function(){o+=1,r[t]=Array.prototype.slice.call(arguments),o===i&&n.done(r)}}for(var u=0;u<i;u++)t[u].then(a(u));return n},chain:function t(n,r){var o=new e;return 0===n.length?o.done.apply(o,r):n[0].apply(null,r).then(function(){n.splice(0,1),t(n,arguments).then(function(){o.done.apply(o,arguments)})}),o},ajax:n,get:r("GET"),post:r("POST"),put:r("PUT"),del:r("DELETE"),ENOXHR:1,ETIMEOUT:2,ajaxTimeout:0};"function"==typeof define&&define.amd?define(function(){return o}):t.promise=o}(this);
